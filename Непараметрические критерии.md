---
date: 2024-10-15
tags:
  - theory
---
Используются для сравнения выборок, не распределенных нормально.
# U-критерий Манна-Уитни
Используется для оуенки различий между двумя несвязными выборками по уровню количественно измеренного признака, если нет подтверждения нормальности распределения.

Позволяет выявлять различия в значении признака между малыми выборками (если дисперсии различны).

Гипотезы (об однородности двух выборок):
- "Выборки однородны, т.е. получены из одной генеральной совокупности"
- "Выборки неоднороны, т.е. получены из разных генеральных совокупностей"

Алгоритм U-теста:
1. Обе выборки соединяются в единую выборку. При этом запоминается, к какой выборке относится каждый элемент массива.
2. Общая выборка ранжируется по возрастанию
   Правила ранжирования:
   - меньшему значению начисляется меньший ранг
   - наименьшему значению начисляется ранг 1
   - наибольшему значению начисляется ранг, соответствующий количеству ранжируемых значений $n_{1}+n_{2}$.
   - если несколько значений равны, им начисляется ранг, представляющий собой среднее значений тех рангов, которые они получили бы, если бы не были равны
   - общая сумма рангов должна совпадать с расчетной $\sum\limits R_{i}=\frac{N(N+1)}{N}$
3. Разбить единую выборку на прежние две выборки
4. Подсчитать сумму рангов отдельно по каждой выборке
   Проверить, совпадает ли общая сумма рангов с расчетной.
5. Находим наблюдаемое значение критерия $T_\text{набл}=$сумма рангов элементов меньшей группы
6. Если объем каждой выборки не превосходит 25, то находим критические точки для двусторонней критической области по специальным таблицам
7. Сравниваем $T_\text{набл}$ и критические точки

## При n>=20
При большой численности групп обычно используют нормальный закон распределения. Оказывается, что с ростом численности групп распределение случайной величины $T$ стремится к нормальному $N(m;\sigma)$ при $m=\frac{n_{L}(n_{L}+N_{G}+1)}{2}$, $\sigma=\sqrt{\frac{n_{L}n_{G}(n_{L}+n_{G}+1)}{12}}$, где $n_{L},n_{G}$ - численности меньшей и большей групп соответственно.
В качестве критерия используют нормированную случайную величину $Z=\frac{T-m}{\sigma}$, $Z\sim N(0;1)$.

Т.к. случайная величина $T$ дискретна, а нормальное распределение непрерывно, в качестве компенсации обычно используют поправку Йетса, применение которой приводит к более точным значениям. Случайная величина с поправкой Йетса имеет вид $Z=\frac{|T-m|-\frac{1}{2}}{\sigma}$.

# Однофакторный критерий Краскела-Уоллиса
Позволяет сравнивать распределения нескольких (>2) выборок.

Критерий также является ранговым, первые 4 пункта совпадают с алгоритмом критерия Манна-Уитни
5. Находим средние ранги (сумма рангов/количество элементов)
6. Вычисляем статистику по формуле $$H=\frac{12}{N(N+1)}\sum\limits_{i=1}^{k}n_{i}(\overline{R}_{i}-\overline{\overline{R}})^{2}$$где $\overline{R}_{i}$ - средние ранги выборок, $\overline{\overline{R}}$ - средний ранг по всем выборкам, $N=n_{1}+\dots+n_{k}$, $n_{i}$ - объемы выборок
